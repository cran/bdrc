<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Birgir Hrafnkelsson" />


<title>Background</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>







<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Background</h1>
<h4 class="author">Birgir Hrafnkelsson</h4>



<p>Most methods for directly measuring the discharge of a water stream
are time-consuming and expensive. Therefore, indirect methods for
measuring the discharge are usually applied. A popular method for
inferring discharge is to fit a model that describes the relationship
between the discharge and the water level, also referred to as water
elevation. Such a model is called a discharge rating curve, and one
widely used in hydrology is the power-law rating curve, given by <span class="math inline">\(Q(h)=a(h-c)^b\)</span>, where <span class="math inline">\(Q(h)\)</span> is the discharge, <span class="math inline">\(h\)</span> is the water elevation, and <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>
and <span class="math inline">\(c\)</span> are constants. However, the
power-law rating curve is not always able to adequately describe the
relationship between discharge and water elevation. Hrafnkelsson et
al. (2022) proposed a novel extension to the power-law rating curve
referred to as the generalized power-law rating curve. Its form is <span class="math inline">\(Q(h)=a(h-c)^{f(h)}\)</span>, where the power-law
exponent, <span class="math inline">\(f(h)\)</span>, is a function of
water elevation. This generalization allows the water stream’s
cross-sectional geometry to affect the power-law exponent, lending more
flexibility to the rating curve to adequately describe the relationship
between discharge and water elevation.</p>
<div id="bayesian-generalized-power-law-rating-curves" class="section level2">
<h2>Bayesian Generalized Power-Law Rating Curves</h2>
<p>The power-law model is commonly assumed in hydraulic practice to fit
rating curves, and as mentioned above, its form is</p>
<p><span class="math display">\[Q(h) = a(h-c)^{b}\]</span> (1)</p>
<p>where <span class="math inline">\(Q\)</span>, <span class="math inline">\(h\)</span>, <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>
and <span class="math inline">\(c\)</span> are as before, see e.g.,
Venetis (1970), Clarke (1999) and Clarke et al. (2000). The second type
of rating curve is the generalized power-law rating curve. Its
construction is based on the hydraulics of open channel flow given by
the formulas of Chézy and Manning which are of the form</p>
<p><span class="math display">\[Q = KR^{x}AS^{1/2}\]</span> (2)</p>
<p>where <span class="math inline">\(K\)</span> and <span class="math inline">\(x\)</span> are constants; <span class="math inline">\(A\)</span> is the area of the cross section; <span class="math inline">\(S\)</span> is the slope of the channel; and <span class="math inline">\(R\)</span> is the hydraulic radius, given by <span class="math inline">\(R = A/P\)</span>, where <span class="math inline">\(P\)</span> is the wetted perimeter. According to
Chézy <span class="math inline">\(x = 1/2\)</span>, while Manning
claimed that <span class="math inline">\(x = 2/3\)</span> (Chow, 1959).
The form of the generalized power-law rating curve is</p>
<p><span class="math display">\[Q = a(h − c)^{f(h)}\]</span> (3)</p>
<p>where <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> are constants; and <span class="math inline">\(f(h)\)</span> is a function of <span class="math inline">\(h\)</span>, referred to as the power-law exponent.
The relationship between (2) and (3) can be found by equating these two
equations. In particular, the form of <span class="math inline">\(f(h)\)</span> can be derived, namely,</p>
<p><span class="math display">\[f(h) = \frac{(x+1)\{ \log A(h) - \log
A(1) \}  - x \{ \log P(h) - \log P(1)  \}}{\log h}\]</span> (4)</p>
<p>Thus, <span class="math inline">\(f(h)\)</span> is a function of the
constant <span class="math inline">\(x\)</span>, the cross-sectional
area <span class="math inline">\(A\)</span>, and the wetted perimeter
<span class="math inline">\(P\)</span>. A Bayesian approach is proposed
for estimating the parameters of the power-law model and the generalized
power-law model. Bayesian inference requires specification of prior
densities for unknown parameters and unknown quantities, along with a
full probabilistic specification of the observed data. The goal of
Bayesian inference is to obtain the posterior density of the model
parameters, and then interrogate the posterior by calculating summary
statistics, such as the posterior mean and the 95% posterior intervals.
<!-- Bayesian inference is based on the posterior density and summary statistics such as the posterior mean and 95% posterior intervals are based on the posterior density.  -->
Analytical formulas for these summary statistics are intractable in most
cases and thus they are computed by generating samples from the
posterior density using Markov chain Monte Carlo simulation. The
Bayesian power-law model is presented on a logarithmic scale as,</p>
<p><span class="math display">\[\log(Q_i) = \log(a) + b \log(h_i -c) +
\epsilon_i, \quad i = 1,...,n,\]</span> (5)</p>
<p>where <span class="math inline">\(\epsilon_i\)</span> follows a
normal distribution with mean zero and variance <span class="math inline">\(\sigma_{\epsilon}^2\)</span>, <span class="math inline">\(n\)</span> is the number of paired observations,
and <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> are as before. The Bayesian inference
scheme implemented for the power-law model is standard, however, for
efficient posterior simulation, first, samples are obtained from the
joint marginal posterior density of <span class="math inline">\((c,
\sigma_{\epsilon}^2)\)</span>, then samples are obtained from the
conditional posterior density of <span class="math inline">\((\log(a),
b)\)</span> conditional on <span class="math inline">\((c,
\sigma_{\epsilon}^2)\)</span>. The Bayesian generalized power-law model
is presented as a Bayesian hierarchical model. The function <span class="math inline">\(f(h)\)</span> is modeled at the latent level as
<span class="math inline">\(b\)</span> plus a mean zero continuous
stochastic process <span class="math inline">\(\beta(h)\)</span>, which
is assumed to be twice mean-square differentiable. The model is
presented on a logarithmic scale as,</p>
<p><span class="math display">\[\log (Q_i) = \log (a) + (b + \beta(h_i))
\log(h_i -c) + \varepsilon_i, \quad i = 1,...,n,\]</span> (6)</p>
<p>where <span class="math inline">\(\epsilon_i\)</span> follows a
normal distribution with mean zero and variance <span class="math inline">\(\sigma_{\epsilon}^2(h_i)\)</span> that can vary
with water elevation. Here the parameters <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>
and <span class="math inline">\(c\)</span> play a similar role as in the
Bayesian power-law model. The stochastic process <span class="math inline">\(\beta(h)\)</span> is assumed a priori to be a
Gaussian process governed by a Matérn covariance function with
smoothness parameter <span class="math inline">\(\nu = 2.5\)</span>, see
Matérn (1960). This model is constrained by setting <span class="math inline">\(b=1.835\)</span>. An efficient posterior
simulation is achieved by sampling from the joint posterior density of
the hyperparameters of the model, and then sampling from the conditional
density of the latent parameters given the hyperparameters.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Chow, V. (1959). <em>Open-Channel Hydraulics</em>. McGraw-Hill. New
York.</p>
<p>Clarke, R. (1999). <em>Uncertainty in the estimation of mean annual
flood due to rating-curve indefinition.</em> Journal of Hydrology
222(1-4). 185–190. doi: <a href="https://doi.org/10.1016/s0022-1694(99)00097-9" class="uri">https://doi.org/10.1016/s0022-1694(99)00097-9</a></p>
<p>Clarke, R., Mendiondo, E., Brusa L. (2000). <em>Uncertainties in mean
discharges from two large South American rivers due to rating curve
variability.</em> Hydrological Sciences 45(2). 221–236. doi: <a href="https://doi.org/10.1080/02626660009492321" class="uri">https://doi.org/10.1080/02626660009492321</a></p>
<p>Hrafnkelsson, B., Sigurdarson, H., Rögnvaldsson, S., Jansson, A. Ö.,
Vias, R. D., and Gardarsson, S. M. (2022). <em>Generalization of the
power-law rating curve using hydrodynamic theory and Bayesian
hierarchical modeling</em>, Environmetrics, 33(2):e2711. doi: <a href="https://doi.org/10.1002/env.2711" class="uri">https://doi.org/10.1002/env.2711</a></p>
<p>Matérn, B. (1960). <em>Spatial variation. Stochastic models and their
application to some problems in forest surveys and other sampling
investigations.</em> Meddelanden från statens Skogsforskningsinstitut.
49(5).</p>
<p>Venetis, C. (1970). <em>A note on the estimation of the parameters in
logarithmic stage-discharge relationships with estimates of their
error.</em> International Association of Scientific Hydrology. Bulletin
XV 2(6). 105–111. doi: <a href="https://doi.org/10.1080/02626667009493957" class="uri">https://doi.org/10.1080/02626667009493957</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
