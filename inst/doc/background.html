<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Birgir Hrafnkelsson" />


<title>Background</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>






<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Background</h1>
<h4 class="author">Birgir Hrafnkelsson</h4>



<p>Most methods for directly measuring the discharge of a water stream are time-consuming and expensive. Therefore, indirect methods for measuring the discharge are usually applied. A popular method for inferring discharge is to fit a model that describes the relationship between discharge and water level, also referred to as stage. Such a model is called a discharge rating curve, and one, widely used in hydrology, is the power-law rating curve, <span class="math inline">\(Q(h)=a(h-c)^b\)</span>, where <span class="math inline">\(Q(h)\)</span> is the discharge, <span class="math inline">\(h\)</span> is the water stage, and <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> are constants. However, the power-law rating curve is not always able to adequately describe the relationship between discharge and stage. Hrafnkelsson et al. (2020) proposed a novel extension to the power-law rating curve referred to as the generalized power-law rating curve. Its form is <span class="math inline">\(Q(h)=a(h-c)^{f(h)}\)</span>, where the power-law exponent, <span class="math inline">\(f(h)\)</span>, is a function of stage. This generalization allows the water stream cross-section’s geometry to affect the power-law exponent and thus lends more flexibility to the rating curve to adequately describe the relationship between discharge and stage.</p>
<div id="bayesian-generalized-power-law-rating-curves" class="section level2">
<h2>Bayesian Generalized Power-Law Rating Curves</h2>
<p>The power-law model is commonly assumed in hydraulic practice to fit rating curves, and as mention above, its form is</p>
<p><span class="math display">\[Q(h) = a(h-c)^{b}\]</span> (1) where <span class="math inline">\(Q\)</span>, <span class="math inline">\(h\)</span>, <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> are as before, see e.g., Venetis (1970), Clarke (1999) and Clarke et al. (2000). The second type of rating curves is the generalized power-law model. Its construction is based on the hydraulics of open channel flow given the formulas of Chézy and Manning which are of the form</p>
<p><span class="math display">\[Q = KR^{x}AS^{1/2}\]</span> (2)</p>
<p>where <span class="math inline">\(K\)</span> is a constant, <span class="math inline">\(R\)</span> is the hydraulic radius, <span class="math inline">\(x\)</span> is constant, <span class="math inline">\(A\)</span> is the cross-section area, <span class="math inline">\(S\)</span> is the slope of the channel, further, <span class="math inline">\(R = A/P\)</span> where <span class="math inline">\(P\)</span> is the wetted perimeter. According to Chézy <span class="math inline">\(x = 1/2\)</span> while Manning claimed that <span class="math inline">\(x = 2/3\)</span> (Chow, 1959). The form of the generalized rating curve is</p>
<p><span class="math display">\[Q = a(h − c)^{f(h)}\]</span> (3)</p>
<p>where <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> are constants and <span class="math inline">\(f(h)\)</span> is a function of <span class="math inline">\(h\)</span> and referred to as the generalized power-law exponent. The relationship between (2) and (3) can be found by equating these two equations. In particular, the form of <span class="math inline">\(f(h)\)</span> can be derived, namely,</p>
<p><span class="math display">\[f(h) = \frac{(x+1)\{ \log A(h) - \log A(1) \}  - x \{ \log P(h) - \log P(1)  \}}{\log h}\]</span> (4)</p>
<p>Thus, <span class="math inline">\(f(h)\)</span> is a function of the constant <span class="math inline">\(x\)</span>, the cross section <span class="math inline">\(A\)</span> and the wetted perimeter <span class="math inline">\(P\)</span>. The estimation approach is proposed for the estimation of the power-law model and the generalized power-law model. Bayesian inference requires specification of prior densities for unknown parameters and unknown quantities along with a full probabilistic specification of the observed data. Bayesian inference is based on the posterior density and summary statistics such as the posterior mean and 95% posterior intervals are based on the posterior density. Analytical formulas for these summary statistics are intractable in most cases and thus they are computed by generating samples from the posterior density using Markov chain Monte Carlo simulation. The Bayesian power-law model is presented on a logarithmic scale as,</p>
<p><span class="math display">\[\log(Q_i) = \log(a) + b \log(h_i -c) + \epsilon_i, \quad i = 1,...,n,\]</span> (5)</p>
<p>where <span class="math inline">\(\epsilon_i\)</span> follows a normal distribution with mean zero and variance <span class="math inline">\(\sigma_{\epsilon}^2\)</span>, <span class="math inline">\(n\)</span> is the number of paired observations and <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> are as before. The Bayesian inference scheme implemented for the power-law model is standard, however, for efficient posterior simulation, first, samples from the joint marginal posterior density of <span class="math inline">\((c, \sigma_{\epsilon}^2)\)</span> are obtained, then samples from the conditional posterior density of <span class="math inline">\((\log(a), b)\)</span> conditional on <span class="math inline">\((c, \sigma_{\epsilon}^2)\)</span> are obtained. The Bayesian generalized power-law model is presented as a Bayesian hierarchical model. The function <span class="math inline">\(f(h)\)</span> is modeled at the latent level as <span class="math inline">\(b\)</span> plus a mean zero continuous stochastic process which is assumed to be twice mean square differentiable. The model is presented on a logarithmic scale,</p>
<p><span class="math display">\[\log (Q_i) = \log (a) + (b + \beta(h_i)) \log(h_i -c) + \varepsilon_i, \quad i = 1,...,n,\]</span> (6)</p>
<p>where <span class="math inline">\(\epsilon_i\)</span> follows a normal distribution with mean zero and variance <span class="math inline">\(\sigma(h_i)_{\epsilon}^2\)</span> that can vary with stage. Here the parameters <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> play a similar role as in the Bayesian power law model. The stochastic process <span class="math inline">\(\beta(h)\)</span> is assumed a priori to be a Gaussian process governed by a Matérn covariance function with smoothness parameter <span class="math inline">\(\nu = 2.5\)</span>, see Matérn (1960). This model is constrained by setting <span class="math inline">\(b=1.835\)</span>. An efficient posterior simulation is achieved by sampling from the joint posterior density of the hyperparameters of the model, and then sampling from the conditional density of the latent parameters conditional on the hyperparameters.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Hrafnkelsson, B., Sigurdarson, H., and Gardarsson, S. M. (2020). <em>Generalization of the power-law rating curve using hydrodynamic theory and Bayesian hierarchical modeling</em>. arXiv preprint 2010.04769.</p>
<p>Clarke, R. (1999). <em>Uncertainty in the estimation of mean annual flood due to rating-curve indefinition.</em> Journal of Hydrology 222(1-4). 185–190.</p>
<p>Clarke, R., Mendiondo, E., Brusa L. (2000). <em>Uncertainties in mean discharges from two large South American rivers due to rating curve variability.</em> Hydrological Sciences 45(2). 221–236.</p>
<p>Venetis C. (1970). <em>A note on the estimation of the parameters in logarithmic stage-discharge relationships with estimates of their error.</em> International Association of Scientific Hydrology. Bulletin XV 2(6). 105–111.</p>
<p>V. Chow (1959). <em>Open-Channel Hydraulics</em>. McGraw-Hill. New York.</p>
<p>Matérn, B. (1960). <em>Spatial variation. Stochastic models and their application to some problems in forest surveys and other sampling investigations.</em> Meddelanden från statens Skogsforskningsinstitut. 49(5).</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
